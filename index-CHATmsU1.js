(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function h(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=h(s);fetch(s.href,r)}})();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const X=document.getElementById("game-canvas"),e=X.getContext("2d"),N=document.getElementById("high-score");document.getElementById("message-overlay");document.getElementById("message-title");document.getElementById("message-text");const K=document.getElementById("p1-score"),$=document.getElementById("p1-lives"),C=document.getElementById("p2-ui"),q=document.getElementById("p2-score"),J=document.getElementById("p2-lives"),n=960,a=720,G=.6,L=5,W=-15,M=1.5,Q=5e3,Y="retroArcadeHighScore",Z=3,D=2e4,tt=1500,O=3,A=[{x:150,y:60},{x:n-150,y:60}];let F=parseInt(localStorage.getItem(Y)||"0"),S=1,x=[],f=[],g=[],m=[],P,u={},c="playerSelect",z=0,E=1;function y(t,i){return Math.floor(Math.random()*(i-t+1)+t)}class j{constructor(i,h,o){this.id=i,this.width=40,this.height=40,this.x=n/2-this.width/2+(i===1?-50:50),this.y=a-this.height-50,this.vx=0,this.vy=0,this.onGround=!1,this.sprite=o,this.onFrozenPlatform=!1,this.controls=h,this.isDead=!1,this.score=0,this.lives=Z,this.nextExtraLifeScore=D,this.scoreEl=document.getElementById(`p${i}-score`),this.livesEl=document.getElementById(`p${i}-lives`)}draw(){this.isDead||(e.font="40px sans-serif",e.textAlign="center",e.textBaseline="middle",e.fillText(this.sprite,this.x+this.width/2,this.y+this.height/2))}update(){this.isDead||(this.onFrozenPlatform?!u[this.controls.left]&&!u[this.controls.right]?(this.vx*=.97,Math.abs(this.vx)<.1&&(this.vx=0)):(u[this.controls.left]&&(this.vx=-L),u[this.controls.right]&&(this.vx=L)):(this.vx=0,u[this.controls.left]&&(this.vx=-L),u[this.controls.right]&&(this.vx=L)),this.x+=this.vx,this.x<-this.width&&(this.x=n),this.x>n&&(this.x=-this.width),this.vy+=G,this.y+=this.vy,this.onGround=!1,this.onFrozenPlatform=!1)}jump(){this.onGround&&!this.isDead&&(this.vy=W)}die(){if(!this.isDead){this.lives--,I();for(let i=0;i<50;i++)m.push(new R(this.x+this.width/2,this.y+this.height/2,this.sprite));this.lives<=0?(this.isDead=!0,at()):(this.x=n/2-this.width/2,this.y=a-this.height-100,this.vx=0,this.vy=0)}}addScore(i){this.score+=i,this.score>=this.nextExtraLifeScore&&(this.lives++,this.nextExtraLifeScore+=D),this.score>F&&(F=this.score,localStorage.setItem(Y,F.toString())),I()}}class T{constructor(i,h,o,s,r){this.width=o,this.height=s,this.x=i,this.y=h,this.vx=0,this.vy=0,this.sprite=r,this.isFlipped=!1,this.flipTimer=0,this.onGround=!1,this.hitAnimationTimer=0}draw(){if(e.save(),this.hitAnimationTimer>0&&Math.floor(this.hitAnimationTimer/50)%2===0){e.restore();return}this.isFlipped&&(e.translate(this.x+this.width/2,this.y+this.height/2),e.rotate(Math.PI),e.translate(-(this.x+this.width/2),-(this.y+this.height/2))),e.font="36px sans-serif",e.textAlign="center",e.textBaseline="middle",e.fillText(this.sprite,this.x+this.width/2,this.y+this.height/2),e.restore()}update(){if(this.hitAnimationTimer>0&&(this.hitAnimationTimer-=1e3/60),this.isFlipped&&(this.flipTimer-=1e3/60,this.flipTimer<=0&&(this.isFlipped=!1,this.y-=5)),this.x+this.width<0||this.x>n){const i=A[y(0,A.length-1)];this.x=i.x,this.y=i.y,this.vy=0}this.vy+=G,this.y+=this.vy,this.onGround=!1,g.forEach(i=>{this.x<i.x+i.width&&this.x+this.width>i.x&&this.y+this.height>=i.y&&this.y+this.height<=i.y+i.height+10&&this.vy>=0&&(this.y=i.y-this.height,this.vy=0,this.onGround=!0,i.isFloor||(this.x+=i.vx))})}flip(){this.isFlipped||(this.isFlipped=!0,this.flipTimer=Q,this.vy=-5)}}class _ extends T{constructor(i,h){super(i,h,36,36,"👾"),this.vx=(Math.random()<.5?1:-1)*M}update(){super.update(),this.isFlipped||(this.x+=this.vx)}}class it extends T{constructor(i,h){super(i,h,36,36,"👻"),this.vx=(Math.random()<.5?1:-1)*M*1.8}update(){super.update(),this.isFlipped||(this.x+=this.vx)}}class et extends T{constructor(i,h){super(i,h,36,36,"👽"),this.vx=(Math.random()<.5?1:-1)*M*.8,this.jumpCooldown=y(80,200)}update(){super.update(),this.jumpCooldown--,this.onGround&&this.jumpCooldown<=0&&!this.isFlipped&&(this.vy=-8,this.onGround=!1,this.jumpCooldown=y(100,300)),this.isFlipped||(this.x+=this.vx)}}class k extends T{constructor(i,h,o){super(i,h,36,36,"💣"),this.vx=0,this.timer=y(3e3,5e3),this.platform=o,this.y=o.y-this.height,this.x=o.x+o.width/2-this.width/2}update(){super.update(),this.timer-=1e3/60,this.timer<=0&&!this.isFlipped&&this.explode(),this.platform&&(this.x=this.platform.x+this.platform.width/2-this.width/2)}explode(){const i=f.indexOf(this);i>-1&&f.splice(i,1);for(let h=0;h<40;h++)m.push(new R(this.x,this.y,this.sprite));this.platform&&this.platform.freeze()}flip(){this.timer=Math.min(this.timer,100)}}class st extends T{constructor(i,h){super(i,h,40,40,"👹"),this.vx=(Math.random()<.5?1:-1)*M*.7,this.hitsLeft=2}flip(){this.isFlipped||(this.hitsLeft--,this.vy=-3,this.hitsLeft<=0?super.flip():(this.hitAnimationTimer=300,this.sprite="👺"))}update(){super.update(),this.isFlipped||(this.x+=this.vx)}}class l{constructor(i,h,o,s=20,r=!1){this.x=i,this.y=h,this.width=o,this.height=s,this.color="#0074D9",this.isFloor=r,this.isFrozen=!1,this.frozenTimer=0,this.vx=0,this.startX=i,this.range=0}draw(){e.fillStyle=this.isFrozen?"#7FDBFF":this.color,e.fillRect(this.x,this.y,this.width,this.height)}update(){this.isFrozen&&(this.frozenTimer-=1e3/60,this.frozenTimer<=0&&(this.isFrozen=!1)),this.vx!==0&&(this.x+=this.vx,(this.x<=this.startX||this.x>=this.startX+this.range)&&(this.vx*=-1))}freeze(){this.isFrozen=!0,this.frozenTimer=7e3}makeMobile(i,h){return this.vx=i,this.range=h,i<0&&(this.startX=this.x-h),this}}class ht{constructor(){this.width=50,this.initialHeight=50,this.height=this.initialHeight,this.x=n/2-this.width/2,this.y=a-180,this.usesLeft=O,this.cooldown=0}draw(){this.usesLeft<=0||(e.save(),this.cooldown>0&&(e.globalAlpha=.5),e.fillStyle="#ff4136",e.fillRect(this.x,this.y,this.width,this.height),e.strokeStyle="#fff",e.lineWidth=3,e.strokeRect(this.x,this.y,this.width,this.height),e.fillStyle="#fff",e.font='30px "Press Start 2P"',e.textAlign="center",e.textBaseline="middle",e.fillText("B",this.x+this.width/2,this.y+this.height/2+2),e.restore())}update(){this.cooldown>0&&(this.cooldown-=1e3/60)}hit(){if(this.usesLeft>0&&this.cooldown<=0){this.usesLeft--,this.cooldown=500,f.forEach(h=>h.flip());for(let h=0;h<50;h++)m.push(new R(this.x+this.width/2,this.y,"💥"));const i=this.initialHeight/O;this.height-=i,this.y+=i}}reset(){this.usesLeft=O,this.height=this.initialHeight,this.y=a-180}}class R{constructor(i,h,o){this.x=i,this.y=h,this.sprite=o,this.isEmoji=new RegExp("\\p{Emoji}","u").test(o),this.size=this.isEmoji?20:Math.random()*5+2,this.vx=(Math.random()-.5)*8,this.vy=(Math.random()-.5)*8,this.life=100}draw(){e.globalAlpha=this.life/100,this.isEmoji?(e.font=`${this.size}px sans-serif`,e.fillText(this.sprite,this.x,this.y)):(e.fillStyle=this.sprite,e.fillRect(this.x,this.y,this.size,this.size)),e.globalAlpha=1}update(){this.x+=this.vx,this.y+=this.vy,this.vy+=G*.1,this.life--,this.isEmoji&&this.size>.2&&(this.size-=.2)}}const H=[()=>[new l(0,550,250),new l(n-250,550,250),new l(300,400,360),new l(0,250,350),new l(n-350,250,350)],()=>[new l(0,580,200),new l(n-200,580,200),new l(250,450,150),new l(n-400,450,150),new l(0,300,200),new l(n-200,300,200),new l(300,180,360)],()=>[new l(0,550,200),new l(n-200,550,200),new l(380,400,200).makeMobile(1,100),new l(0,250,300),new l(n-300,250,300)],()=>[new l(0,580,150).makeMobile(1.2,80),new l(n-150,580,150).makeMobile(-1.2,80),new l(300,420,360),new l(0,250,350).makeMobile(1.5,150),new l(n-350,250,350).makeMobile(-1.5,150)]];function ot(t){S=1,x=[];const i={left:"a",right:"d",jump:"w"};if(x.push(new j(1,i,"🤖")),t===2){const h={left:"arrowleft",right:"arrowright",jump:"arrowup"};x.push(new j(2,h,"🧑‍🚀")),C.classList.remove("hidden")}else C.classList.add("hidden");P=new ht,U(S),I(),c="playing"}function U(t){const i=Math.floor((t-1)/4)%H.length;g=[new l(0,a-40,n,40,!0),...H[i]()],g.forEach(s=>{s.isFrozen=!1}),f=[],P.reset();const h=Math.min(t,50),o=2+Math.floor(h/2);for(let s=0;s<o;s++){const r=A[y(0,A.length-1)],d=r.x,w=r.y;let p=Math.random();if(h>=25&&p<.15)f.push(new st(d,w));else if(h>=20&&p<.3){const B=g.filter(v=>!v.isFloor&&v.vx===0&&!f.some(b=>b instanceof k&&b.platform===v));if(B.length>0){const v=B[y(0,B.length-1)];f.push(new k(0,0,v))}else f.push(new _(d,w))}else h>=10&&p<.5?f.push(new et(d,w)):h>=5&&p<.75?f.push(new it(d,w)):f.push(new _(d,w))}}function nt(){c==="playing"?(x.forEach(t=>t.update()),f.forEach(t=>t.update()),g.forEach(t=>t.update()),P.update(),rt(),f.length===0&&x.some(t=>!t.isDead)&&(S++,c="levelTransition",z=tt)):c==="levelTransition"&&(z-=1e3/60,z<=0&&(U(S),c="playing")),m.forEach(t=>t.update()),m=m.filter(t=>t.life>0)}function rt(){x.forEach(t=>{if(t.isDead)return;const i=P;i.usesLeft>0&&t.x<i.x+i.width&&t.x+t.width>i.x&&t.y+t.height>=i.y&&t.y+t.height<=i.y+10+t.vy&&t.vy>=0&&(t.y=i.y-t.height,t.vy=0,t.onGround=!0);let h=t.onGround,o=!1;g.forEach(s=>{if(t.x<s.x+s.width&&t.x+t.width>s.x&&t.y+t.height>=s.y&&t.y+t.height<=s.y+s.height+t.vy&&t.vy>=0&&(t.y=s.y-t.height,t.vy=0,t.onGround=!0,h=!0,s.isFrozen&&(o=!0),t.x+=s.vx),t.x<s.x+s.width&&t.x+t.width>s.x&&t.y>s.y&&t.y<=s.y+s.height&&t.vy<0){t.y=s.y+s.height,t.vy=0;const r=t.x+t.width/2;f.forEach(d=>{const w=Math.abs(d.y+d.height-s.y)<10,p=d.x<r+20&&d.x+d.width>r-20;!d.isFlipped&&w&&p&&(d.flip(),t.addScore(50))})}}),t.onGround=h,t.onFrozenPlatform=o,t.x<i.x+i.width&&t.x+t.width>i.x&&t.y>i.y&&t.y<=i.y+i.height&&t.vy<0&&(t.y=i.y+i.height,t.vy=0,i.hit()),f.forEach((s,r)=>{if(t.x<s.x+s.width&&t.x+t.width>s.x&&t.y<s.y+s.height&&t.y+t.height>s.y)if(s.isFlipped){f.splice(r,1);for(let d=0;d<20;d++)m.push(new R(s.x,s.y,s.sprite));t.addScore(200)}else t.die()})});for(let t=0;t<f.length;t++)for(let i=t+1;i<f.length;i++){const h=f[t],o=f[i];if(h.x<o.x+o.width&&h.x+h.width>o.x&&h.y<o.y+o.height&&h.y+h.height>o.y&&!h.isFlipped&&!o.isFlipped&&h.onGround&&o.onGround){const s=h.vx;h.vx=o.vx,o.vx=s,h.x<o.x?(h.x-=1,o.x+=1):(h.x+=1,o.x-=1)}}}function lt(){e.clearRect(0,0,n,a),c==="playerSelect"?ft():(g.forEach(t=>t.draw()),P.draw(),f.forEach(t=>t.draw()),x.forEach(t=>t.draw()),c==="paused"?(e.fillStyle="rgba(0, 0, 0, 0.5)",e.fillRect(0,0,n,a),e.fillStyle="white",e.font='50px "Press Start 2P"',e.textAlign="center",e.fillText("PAUSED",n/2,a/2)):c==="levelTransition"?(e.fillStyle="rgba(0, 0, 0, 0.5)",e.fillRect(0,0,n,a),e.fillStyle="white",e.font='50px "Press Start 2P"',e.textAlign="center",e.fillText(`LEVEL ${S}`,n/2,a/2)):c==="gameOver"&&dt()),m.forEach(t=>t.draw())}function ft(){e.textAlign="center",e.fillStyle="#ff4136",e.font='80px "Press Start 2P"',e.fillText("DRAICOR BROS",n/2+5,a/2-150+5),e.fillStyle="#ffdc00",e.fillText("DRAICOR BROS",n/2,a/2-150),e.fillStyle="white",e.font='40px "Press Start 2P"',e.fillText("SELECT PLAYERS",n/2,a/2-50),e.font='30px "Press Start 2P"',e.fillStyle=E===1?"#ffdc00":"white",e.fillText("1 PLAYER",n/2,a/2+30),e.fillStyle=E===2?"#ffdc00":"white",e.fillText("2 PLAYERS",n/2,a/2+90),e.font='20px "Press Start 2P"',e.fillStyle="white",e.fillText("Use Arrow Keys and Enter",n/2,a/2+180)}function dt(){e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(0,0,n,a),e.fillStyle="#ff4136",e.font='60px "Press Start 2P"',e.textAlign="center",e.fillText("GAME OVER",n/2,a/2-50),e.fillStyle="white",e.font='20px "Press Start 2P"',e.fillText("Press Enter to return to menu",n/2,a/2+50)}function at(){x.every(i=>i.isDead)&&(c="gameOver")}function I(){N.textContent=F.toString().padStart(6,"0"),x[0]&&(K.textContent=x[0].score.toString().padStart(6,"0"),$.textContent=x[0].lives.toString()),x[1]&&(q.textContent=x[1].score.toString().padStart(6,"0"),J.textContent=x[1].lives.toString())}function V(){nt(),lt(),requestAnimationFrame(V)}window.addEventListener("keydown",t=>{var h,o;const i=t.key.toLowerCase();u[i]=!0,c==="playing"?((i==="w"||i===" ")&&((h=x.find(s=>s.id===1))==null||h.jump()),i==="arrowup"&&((o=x.find(s=>s.id===2))==null||o.jump()),i==="enter"&&(c="paused")):c==="paused"?i==="enter"&&setTimeout(()=>{u.enter&&(c="playing")},100):c==="playerSelect"?(i==="arrowdown"&&(E=2),i==="arrowup"&&(E=1),i==="enter"&&ot(E)):c==="gameOver"&&i==="enter"&&(c="playerSelect",C.classList.add("hidden"))});window.addEventListener("keyup",t=>{u[t.key.toLowerCase()]=!1});I();V();
